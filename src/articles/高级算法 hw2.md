---
date: 2025-06-29
updated: 2025-06-29
category: hw
summary: é«˜çº§ç®—æ³•ä½œä¸š2
---
# hw2

## 0

![hw2](./../../public/assets/hw2.png)





## 1

å…ˆæ¢³ç†ç®€å•åˆ¶è¡¨å“ˆå¸Œ

åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤

1. æŠŠè¾“å…¥çš„ X æŒ‰å­—èŠ‚æˆ–è€…å¤šä¸ªå­—èŠ‚æ‹†è§£ ä¸º ${x_1, x_2,...,x_c}$ , æ¯ä¸ª $x_i$æ˜¯ X æŒ‰é¡ºåºçš„ d ä½çš„å€¼
2. c ä¸ªéšå³è¡¨çš„åˆå§‹åŒ–ï¼Œæ¯ä¸ªè¡¨ æœ‰ $2^d$  ä¸ªæ•°
3. è®¡ç®— $h(x) = Tâ‚€[xâ‚€] \oplus Tâ‚[xâ‚] \oplus ... \oplus T_{c-1}[x_{c-1}]$

å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼š

ï¼ˆ1ï¼‰ç®€å•åˆ¶è¡¨è¦æ±‚å°†é”®æ‹†åˆ†æˆ cä¸ªå›ºå®šä½å®½ dçš„å€¼ã€‚å¯¹ä¸åŒé•¿åº¦çš„å€¼ï¼Œéœ€è¦å¡«å……æˆ–æˆªæ–­å¤„ç†ï¼Œè€Œä¸”æ˜¯çº¿æ€§ç»“æ„ã€‚

ï¼ˆ2ï¼‰ç®€å•åˆ¶è¡¨è¢«è¯æ˜æ˜¯ 4-ç‹¬ç«‹çš„ï¼Œä½†åœ¨è¦æ±‚æé«˜è´¨é‡å“ˆå¸Œä¸”éœ€è¦é«˜äº 4-ç‹¬ç«‹æ€§ä¿è¯çš„åº”ç”¨ä¸­ï¼Œç®€å•åˆ¶è¡¨å¯èƒ½ä¼šå­˜åœ¨é—®é¢˜ã€‚



é’ˆå¯¹é—®é¢˜ 1.

**æ‰­æ›²åˆ¶è¡¨å“ˆå¸Œ**



é’ˆå¯¹é—®é¢˜2.

**åŒè¡¨åˆ¶è¡¨å“ˆå¸Œ**

åŒè¡¨åˆ¶è¡¨å“ˆå¸Œæƒ³æ³•å°±æ˜¯å†å•ä¸ªç®€å•åˆ¶è¡¨å“ˆå¸Œçš„åŸºç¡€ä¸Šå†å¥—ä¸€å±‚ï¼Œç›¸åŒçš„ä¸‰ä¸ªæ­¥éª¤å†èµ°ä¸€éï¼Œåªæ˜¯ c å’Œ d çš„å€¼åœ¨ç¬¬äºŒæ¬¡çš„æ˜ å°„å¯ä»¥å˜åŒ–ã€‚

æˆ‘è§‰å¾—åŠ ä¸ºä¸¤å±‚çš„åˆ¶è¡¨å“ˆå¸Œæƒ³æ³•å¾ˆç®€å•ï¼Œä½†æ˜¯ç¡®å®å¾ˆæœ‰ç”¨ï¼Œç¬¬äºŒå±‚æé«˜äº†æ›´å¤šçš„ç‹¬ç«‹æ€§ï¼Œä½†æ˜¯å¼•å…¥çš„é—®é¢˜æ˜¯æ›´å¤šçš„éšæœºè¡¨åˆå§‹åŒ–çš„æ¶ˆè€—å’Œè®¡ç®—å¤æ‚åº¦çš„å¢åŠ ã€‚



------

## 2



å®šä¹‰ $A_i$ ä¸º $A$ çš„ç¬¬ $i$ è¡Œï¼Œè®°ï¼š

$Y_i = \langle A_i, \mathbf{x} \rangle = \sum_{j=1}^d A_{ij} x_j$

åˆ™$
\|A \mathbf{x}\|_2^2 = \sum_{i=1}^k Y_i^2$



$A_{ij} \sim \mathcal{N}(0, 1/k)$ï¼Œ$\mathbf{x}$ ä¸ºå•ä½å‘é‡ï¼Œæ•…æ¯ä¸ª $Y_i \sim \mathcal{N}(0, 1/k)$ï¼Œæ‰€ä»¥ï¼š

$\mathbb{E}[\|A \mathbf{x}\|_2^2] = \sum_{i=1}^k \mathbb{E}[Y_i^2] = k \cdot \frac{1}{k} = 1$

$\because$

$\mathbb{E}[Y_i^4] = 3 \cdot \operatorname{Var}(Y_i)^2 = 3 \cdot \left(\frac{1}{k}\right)^2 = \frac{3}{k^2}$

$\operatorname{Var}(Y_i^2) = \mathbb{E}[Y_i^4] - (\mathbb{E}[Y_i^2])^2 = \frac{3}{k^2} - \frac{1}{k^2} = \frac{2}{k^2}$

$\therefore$

$\operatorname{Var}(\|A\mathbf{x}\|_2^2) = k \cdot \operatorname{Var}(Y_i^2) = k \cdot \frac{2}{k^2} = \frac{2}{k}$



è‹¥ $\|\mathbf{x}\|_\infty \leq \alpha$ï¼Œåˆ™ï¼š

$\operatorname{Var}(Y_i) = \frac{1}{k} \sum_{j=1}^d x_j^2 \leq \frac{1}{k} \cdot d \cdot \alpha^2$

$\therefore$

$\operatorname{Var}(Y_i^2) \leq 2 \cdot (\operatorname{Var}(Y_i))^2 \leq 2 \cdot \left( \frac{d \alpha^2}{k} \right)^2 = \frac{2 d^2 \alpha^4}{k^2}$

æ€»æ–¹å·®ä¸ºï¼š

$\operatorname{Var}(\|A\mathbf{x}\|_2^2) \leq k \cdot \frac{2 d^2 \alpha^4}{k^2} = \frac{2 d^2 \alpha^4}{k}$



ç”±åˆ‡æ¯”é›ªå¤«ä¸ç­‰å¼ï¼š

$\mathbb{P}\left[ \left| \|A\mathbf{x}\|_2^2 - 1 \right| > \epsilon \right] \leq \frac{\operatorname{Var}(\|A\mathbf{x}\|_2^2)}{\epsilon^2} \leq \frac{2 d^2 \alpha^4}{k \epsilon^2}$

å³è¾¹ä¸è¶…è¿‡ $\delta$ï¼Œå¾—ï¼š

$k \geq \frac{2 d^2 \alpha^4}{\delta \epsilon^2}$



$\therefore $ $\mathbf{x} \in \mathbb{S}^{d-1}$ ä¸” $\|\mathbf{x}\|_\infty \leq \alpha$ï¼Œä¿è¯ï¼š$\mathbb{P}\left[ \left| \|A\mathbf{x}\|_2^2 - 1 \right| > \epsilon \right] < \delta$ çš„å‰æä¸‹ï¼Œå¯ä»¥é™ç»´åˆ° $ O\left( \frac{d^2 \alpha^4}{\delta \epsilon^2} \right)$

------

## 3



LSH çš„æ ¸å¿ƒç›®æ ‡æ˜¯ï¼š

- **è®©â€œç›¸è¿‘â€çš„ç‚¹æœ‰è¾ƒé«˜æ¦‚ç‡å“ˆå¸Œåˆ°åŒä¸€ä¸ªæ¡¶ä¸­**ï¼›
- **è®©â€œè¾ƒè¿œâ€çš„ç‚¹å“ˆå¸Œåˆ°åŒä¸€ä¸ªæ¡¶ä¸­çš„æ¦‚ç‡è¾ƒä½**ã€‚

æˆ‘ä»¬éœ€è¦æ ¹æ®ç»™å®šçš„è·ç¦»å‡½æ•° d(x,y)d(x, y) æ¥æ„é€ ç¬¦åˆä¸Šè¿°æ€§è´¨çš„å“ˆå¸Œå‡½æ•°æ—ã€‚

**1**

æˆ‘ä»¬è€ƒè™‘çš„ç©ºé—´æ˜¯ï¼š

([0,n]d,â€…â€Šd(x,y)=âˆ‘i(minâ¡{âˆ£xiâˆ’yiâˆ£,nâˆ’âˆ£xiâˆ’yiâˆ£})2)([0,n]^d, \; d(x,y) = \sqrt{\sum_i (\min\{|x_i - y_i|, n - |x_i - y_i|\})^2})

#### âœ… è¿™æ˜¯ä¸€ä¸ªâ€œç¯å½¢â€åº¦é‡ç©ºé—´ï¼š

- å¯ä»¥ç†è§£ä¸ºæ¯ä¸€ç»´æ˜¯é•¿åº¦ä¸º nn çš„ç¯ï¼ˆmod nnï¼‰ã€‚
- æ¯”å¦‚å¦‚æœåœ¨ç¬¬ ii ç»´ä¸Š âˆ£xiâˆ’yiâˆ£>n/2|x_i - y_i| > n/2ï¼Œé‚£ä¹ˆâ€œè¿‘â€å®é™…ä¸Šæ„å‘³ç€ç»•ä¸€åœˆåæ–¹å‘èµ°ã€‚

#### ğŸ”§ LSHè®¾è®¡æ€è·¯ï¼š

- **å¯å‘**ï¼šè¯¥è·ç¦»ä¸æ¬§å‡ é‡Œå¾—ç©ºé—´ç±»ä¼¼ï¼Œä½†åœ¨æ¯ä¸€ç»´ä¸Šæœ‰æ¨¡ nn çš„çº¦æŸã€‚

- **æ–¹æ³•**ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»ä¼¼ E2LSHï¼ˆæ¬§å‡ é‡Œå¾—ç©ºé—´ä¸‹çš„ LSHï¼‰çš„æ–¹æ³•ï¼Œå¹¶åœ¨å“ˆå¸Œæ—¶ä½¿ç”¨æ¨¡è¿ç®—ã€‚

    å¯¹æ¯ä¸ªç‚¹ xâˆˆ[0,n]dx \in [0,n]^dï¼Œå¯ä»¥å®šä¹‰å“ˆå¸Œå‡½æ•°ä¸ºï¼š

    ha,b(x)=âŒŠ(aâ‹…x+b)â€Šmodâ€ŠnwâŒ‹h_{a,b}(x) = \left\lfloor \frac{(a \cdot x + b) \bmod n}{w} \right\rfloor

    - å…¶ä¸­ aa æ˜¯ä¸€ä¸ªéšæœºå‘é‡ï¼Œbâˆˆ[0,w]b \in [0, w]ï¼Œww æ˜¯æ¡¶å®½ï¼›
    - æ¨¡è¿ç®—ä½¿å¾—æˆ‘ä»¬å¤„ç†çš„æ˜¯â€œç¯å½¢è·ç¦»â€ã€‚

#### âœï¸ è§£é‡Šï¼š

- ç”±äºç¯å½¢åº¦é‡ç©ºé—´åœ¨æœ¬è´¨ä¸Šåªæ˜¯æ¯ä¸€ç»´ä¸Šåšæ¨¡ nn çš„æŠ•å½±ï¼Œæˆ‘ä»¬åªè¦åœ¨å“ˆå¸Œå‡½æ•°ä¸­æ˜¾å¼å¤„ç†è¿™ä¸ªå‘¨æœŸæ€§å³å¯ï¼›
- å› æ­¤å€Ÿç”¨æ¬§å‡ é‡Œå¾—ç©ºé—´çš„ LSH æ–¹æ³•ï¼ŒåŠ ä¸Šæ¨¡ nnï¼Œå³å¯å®ç°è¿™ä¸€ç©ºé—´ä¸‹çš„ LSHã€‚

**2**

åº¦é‡ç©ºé—´ä¸ºå•ä½çƒé¢ Sdâˆ’1\mathbb{S}^{d-1}ï¼Œè·ç¦»å®šä¹‰ä¸ºï¼š

d(x,y)=arccosâ¡(âŸ¨x,yâŸ©)d(x,y) = \arccos(\langle x, y \rangle)

å³ä¸¤ä¸ªå•ä½å‘é‡ä¹‹é—´çš„å¤¹è§’ã€‚

#### âœ… è¿™æ˜¯â€œçƒé¢å‡ ä½•â€ä¸Šçš„è·ç¦»ï¼š

- æ‰€æœ‰å‘é‡éƒ½æ˜¯å•ä½å‘é‡ï¼›
- ç›¸ä¼¼åº¦ç”¨â€œå¤¹è§’â€æ¥è¡¡é‡ï¼Œå¤¹è§’è¶Šå°ï¼Œå‘é‡è¶Šâ€œç›¸è¿‘â€ã€‚

#### ğŸ”§ LSHè®¾è®¡æ€è·¯ï¼š

- **æ–¹æ³•**ï¼šä½¿ç”¨ **éšæœºè¶…å¹³é¢ï¼ˆRandom Hyperplaneï¼‰æ³•**ã€‚

- è¿™æ˜¯ä¸“é—¨é’ˆå¯¹ä½™å¼¦ç›¸ä¼¼åº¦æˆ–çƒé¢è·ç¦»è®¾è®¡çš„ LSHã€‚

    å“ˆå¸Œå‡½æ•°å½¢å¼å¦‚ä¸‹ï¼š

    hv(x)={1if âŸ¨v,xâŸ©â‰¥00otherwiseh_v(x) =  \begin{cases} 1 & \text{if } \langle v, x \rangle \ge 0 \\ 0 & \text{otherwise} \end{cases}

    - å…¶ä¸­ vv æ˜¯ä¸€ä¸ªä»å•ä½é«˜æ–¯åˆ†å¸ƒä¸­é‡‡æ ·çš„éšæœºå‘é‡ï¼›
    - æœ¬è´¨ä¸Šæ˜¯çœ‹ xx åœ¨éšæœºè¶…å¹³é¢å“ªä¸€ä¾§ã€‚

#### âœï¸ è§£é‡Šï¼š

- è¿™æ ·çš„å“ˆå¸Œå‡½æ•°èƒ½å¤Ÿæ»¡è¶³ï¼šå¦‚æœä¸¤ä¸ªå‘é‡å¤¹è§’è¾ƒå°ï¼Œå®ƒä»¬è¢«åŒä¸€ä¸ªéšæœºè¶…å¹³é¢åˆ†åˆ°åŒä¸€ä¾§çš„æ¦‚ç‡è¾ƒé«˜ï¼›
- å¤¹è§’è¾ƒå¤§çš„å‘é‡è½å…¥åŒä¸€ä¾§çš„æ¦‚ç‡è¾ƒä½ï¼›
- å®Œç¾ç¬¦åˆ LSH çš„æ€§è´¨ã€‚



------

## 4

Oblivious Subspace Embeddingï¼ˆOSEï¼‰æ—¨åœ¨å°†ä»»æ„ $d$ ç»´å­ç©ºé—´ $\Pi$ æ˜ å°„åˆ°ä½ç»´ç©ºé—´ï¼ŒåŒæ—¶è¿‘ä¼¼ä¿ç•™æ‰€æœ‰å‘é‡çš„ $\ell_2$ èŒƒæ•°ã€‚

å¸¸ç”¨æ„é€ ä¸ºç¨€ç–çŸ©é˜µ $S \in \mathbb{R}^{m \times d}$ï¼š

- éšæœºé€‰æ‹©æ˜ å°„æ¡¶ $h(j) \in {1, ..., m}$
- é€‰æ‹©ç¬¦å· $\sigma(j) = \pm 1$
- è®¾ç½® $S_{h(j), j} = \sigma(j)$ï¼Œå…¶ä½™ä¸º 0

å¯¹äºä»»æ„å‘é‡ $x$ï¼Œæœ‰ï¼š

(1âˆ’Îµ)âˆ¥xâˆ¥2â‰¤âˆ¥Sxâˆ¥2â‰¤(1+Îµ)âˆ¥xâˆ¥2(1 - \varepsilon)\|x\|_2 \leq \|Sx\|_2 \leq (1 + \varepsilon)\|x\|_2

å½“ $m = O(d^2/\varepsilon^2)$ æ—¶ï¼Œä¸Šè¿°ä¿è¯ä»¥é«˜æ¦‚ç‡æˆç«‹ã€‚è¯¥æŠ€æœ¯åœ¨ç¨€ç–æ•°æ®é™ç»´ã€çº¿æ€§å›å½’ç­‰åœºæ™¯ä¸­åº”ç”¨å¹¿æ³›ã€‚

------

## 5



åœ¨æ ‡å‡†çš„ç½‘ç»œæµé—®é¢˜ä¸­ï¼Œè¾¹ï¼ˆarcï¼‰æœ‰å®¹é‡é™åˆ¶ï¼Œè€ŒèŠ‚ç‚¹ï¼ˆvertexï¼‰æ²¡æœ‰å®¹é‡é™åˆ¶ã€‚ä½†åœ¨æ‚¨æè¿°çš„é—®é¢˜ä¸­ï¼Œæ¯æ¡è¾¹çš„å®¹é‡ä¸ºæ— ç©·å¤§ï¼ˆå³ä¸é™åˆ¶æµé‡ï¼‰ï¼Œè€Œæ¯ä¸ªèŠ‚ç‚¹ $i$ æœ‰å®¹é‡é™åˆ¶ $c_i$ï¼Œè¡¨ç¤ºæµç»è¯¥èŠ‚ç‚¹çš„æ€»æµé‡ä¸èƒ½è¶…è¿‡ $c_i$ï¼ˆåŒ…æ‹¬æµå…¥å’Œæµå‡ºçš„æ€»å’Œï¼Œå¯¹äºæºç‚¹å’Œæ±‡ç‚¹ï¼Œä¹Ÿé€‚ç”¨ç±»ä¼¼çº¦æŸï¼šæºç‚¹ $s$ çš„æµå‡ºé‡å— $c_s$ é™åˆ¶ï¼Œæ±‡ç‚¹ $t$ çš„æµå…¥é‡å— $c_t$ é™åˆ¶ï¼‰ã€‚

ä¸ºäº†è§£å†³è¿™ç§â€œç‚¹å®¹é‡â€æ¨¡å‹çš„æœ€å¤§æµé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç§ç»å…¸çš„è½¬æ¢æŠ€æœ¯ï¼š**èŠ‚ç‚¹æ‹†åˆ†æ³•**ï¼ˆnode splittingï¼‰ã€‚è¯¥æ–¹æ³•å°†æ¯ä¸ªèŠ‚ç‚¹æ‹†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä»è€Œå°†èŠ‚ç‚¹å®¹é‡è½¬æ¢ä¸ºè¾¹å®¹é‡ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºæ ‡å‡†çš„æœ€å¤§æµé—®é¢˜ã€‚ä¸‹é¢æˆ‘å°†è¯¦ç»†æè¿°ç®—æ³•è®¾è®¡ã€æ­¥éª¤ï¼Œå¹¶è§£é‡Šå…¶æ­£ç¡®æ€§ã€‚

**ç®—æ³•è®¾è®¡ï¼šæœ€å¤§æµæ±‚è§£ç‚¹å®¹é‡æ¨¡å‹**

ç®—æ³•çš„ä¸»è¦æ€æƒ³æ˜¯å°†åŸå§‹å›¾ $G$ è½¬åŒ–ä¸ºä¸€ä¸ªæ–°å›¾ $G'$ï¼Œå…¶ä¸­èŠ‚ç‚¹å®¹é‡è¢«è¡¨ç¤ºä¸ºè¾¹å®¹é‡ã€‚å…·ä½“æ¥è¯´ï¼Œæ¯ä¸ªèŠ‚ç‚¹ $i$ è¢«æ‹†åˆ†æˆä¸€ä¸ªâ€œè¾“å…¥èŠ‚ç‚¹â€ $i_{\text{in}}$ å’Œä¸€ä¸ªâ€œè¾“å‡ºèŠ‚ç‚¹â€ $i_{\text{out}}$ï¼Œå¹¶åœ¨å®ƒä»¬ä¹‹é—´æ·»åŠ ä¸€æ¡è¾¹ï¼Œå®¹é‡ä¸º $c_i$ã€‚åŸå§‹å›¾ä¸­çš„è¾¹ï¼ˆå®¹é‡æ— ç©·å¤§ï¼‰åˆ™åœ¨ $G'$ ä¸­è¢«è½¬åŒ–ä¸ºè¿æ¥è¾“å‡ºèŠ‚ç‚¹åˆ°è¾“å…¥èŠ‚ç‚¹çš„è¾¹ã€‚ç„¶åï¼Œåœ¨ $G'$ ä¸Šè¿è¡Œæ ‡å‡†æœ€å¤§æµç®—æ³•ï¼ˆå¦‚ Dinic ç®—æ³•æˆ– Edmonds-Karp ç®—æ³•ï¼‰ã€‚

**è¾“å…¥**ï¼š

- æœ‰å‘å›¾ $G = (V, E)$ï¼Œå…¶ä¸­ $V$ æ˜¯èŠ‚ç‚¹é›†ï¼Œ$E$ æ˜¯è¾¹é›†ã€‚
- æºç‚¹ $s \in V$ï¼Œæ±‡ç‚¹ $t \in V$ã€‚
- æ¯ä¸ªèŠ‚ç‚¹ $i \in V$ çš„å®¹é‡ $c_i > 0$ï¼ˆåŒ…æ‹¬æºç‚¹å’Œæ±‡ç‚¹ï¼‰ã€‚

**è¾“å‡º**ï¼š

- æœ€å¤§æµå€¼ï¼ˆä»æºç‚¹ $s$ åˆ°æ±‡ç‚¹ $t$ çš„æœ€å¤§æµé‡ï¼‰ã€‚
- ï¼ˆå¯é€‰ï¼‰æµåˆ†é…æ–¹æ¡ˆï¼Œå³æ¯æ¡è¾¹ä¸Šçš„æµé‡å€¼ï¼ˆæ³¨æ„ï¼šåŸå§‹å›¾ä¸­çš„è¾¹å®¹é‡ä¸ºæ— ç©·å¤§ï¼Œæ‰€ä»¥æµåˆ†é…ä»…éœ€æ»¡è¶³èŠ‚ç‚¹å®¹é‡å’Œæµå®ˆæ’ï¼‰ã€‚

**ç®—æ³•æ­¥éª¤**ï¼š

1. **æ„é€ æ–°å›¾ $G'$**:

    - å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ $i \in V$

        - åœ¨ $G'$ ä¸­åˆ›å»ºä¸¤ä¸ªæ–°èŠ‚ç‚¹ï¼š$i_{\text{in}}$ï¼ˆè¾“å…¥èŠ‚ç‚¹ï¼‰å’Œ $i_{\text{out}}$ï¼ˆè¾“å‡ºèŠ‚ç‚¹ï¼‰ã€‚
        - æ·»åŠ ä¸€æ¡ä» $i_{\text{in}}$ åˆ° $i_{\text{out}}$ çš„æœ‰å‘è¾¹ï¼Œå®¹é‡ä¸º $c_i$ã€‚è¿™æ¡è¾¹å°†èŠ‚ç‚¹å®¹é‡é™åˆ¶è½¬åŒ–ä¸ºè¾¹å®¹é‡ã€‚

    - å¯¹äºåŸå§‹å›¾ä¸­çš„æ¯æ¡è¾¹ $(u, v) \in E$

        - åœ¨ $G'$ ä¸­ï¼Œæ·»åŠ ä¸€æ¡ä» $u_{\text{out}}$ åˆ° $v_{\text{in}}$ çš„æœ‰å‘è¾¹ï¼Œå®¹é‡è®¾ç½®ä¸ºä¸€ä¸ªè¶³å¤Ÿå¤§çš„æ•°ï¼ˆå¦‚ $\sum_{i \in V} c_i$ï¼Œè®°ä¸º $C_{\text{sum}}$)ï¼Œä»£è¡¨åŸå§‹è¾¹çš„æ— ç©·å¤§å®¹é‡ï¼ˆå®é™…ä¸­ï¼Œä½¿ç”¨ $C_{\text{sum}}$ å·²è¶³å¤Ÿï¼Œå› ä¸ºæœ€å¤§æµå€¼ä¸ä¼šè¶…è¿‡èŠ‚ç‚¹å®¹é‡ä¹‹å’Œï¼‰ã€‚

    - è®¾ç½® $G'$ çš„æºç‚¹ä¸º $s_{\text{in}}$ï¼ˆåŸå§‹æºç‚¹ $s$ çš„è¾“å…¥èŠ‚ç‚¹ï¼‰ã€‚

    - è®¾ç½® $G'$ çš„æ±‡ç‚¹ä¸º $t_{\text{out}}$ï¼ˆåŸå§‹æ±‡ç‚¹ $t$ çš„è¾“å‡ºèŠ‚ç‚¹ï¼‰ã€‚

    - ï¼ˆå¯é€‰ï¼‰å¦‚æœå›¾ä¸­æœ‰è‡ªç¯æˆ–å¤šé‡è¾¹ï¼Œå¤„ç†æ–¹å¼ç›¸åŒï¼ˆè‡ªç¯è¾¹ $(i, i)$ ä¼šè¢«è½¬åŒ–ä¸º $i_{\text{out}} \to i_{\text{in}}$ è¾¹ï¼Œå®¹é‡æ— é™ï¼‰ã€‚

2. **åœ¨ $G'$ ä¸Šè¿è¡Œæ ‡å‡†æœ€å¤§æµç®—æ³•**:

    - ä½¿ç”¨æ ‡å‡†æœ€å¤§æµç®—æ³•ï¼ˆä¾‹å¦‚ï¼ŒDinic ç®—æ³•æˆ– Ford-Fulkerson çš„ Edmonds-Karp å®ç°ï¼‰åœ¨ $G'$ ä¸Šè®¡ç®—ä» $s_{\text{in}}$ åˆ° $t_{\text{out}}$ çš„æœ€å¤§æµã€‚
    - ç®—æ³•è¾“å‡ºï¼šæœ€å¤§æµå€¼ $f_{\text{max}}$ï¼Œä»¥åŠ $G'$ ä¸­å„æ¡è¾¹ä¸Šçš„æµå€¼ã€‚

3. **æ¢å¤åŸå§‹å›¾çš„æµåˆ†é…**:

    - å¯¹äºåŸå§‹å›¾ä¸­çš„æ¯æ¡è¾¹ $(u, v) \in E$ï¼Œå…¶æµå€¼ç­‰äº $G'$ ä¸­è¾¹ $(u_{\text{out}}, v_{\text{in}})$ çš„æµå€¼ï¼ˆå› ä¸ºè¾¹å®¹é‡æ— é™ï¼Œæµå€¼ç›´æ¥ç”±èŠ‚ç‚¹å®¹é‡çº¦æŸï¼‰ã€‚
    - æœ€å¤§æµå€¼å³ä¸º $G'$ ä¸­çš„æœ€å¤§æµå€¼ $f_{\text{max}}$ã€‚
    - èŠ‚ç‚¹ $i$ çš„æ€»æµé‡ï¼ˆæµç»è¯¥èŠ‚ç‚¹çš„æµé‡ï¼‰ç­‰äº $G'$ ä¸­è¾¹ $(i_{\text{in}}, i_{\text{out}})$ çš„æµå€¼ï¼ˆæ­¤å€¼ä¸è¶…è¿‡ $c_i$ï¼Œä¿è¯äº†èŠ‚ç‚¹å®¹é‡çº¦æŸï¼‰ã€‚

**å¤æ‚æ€§åˆ†æ**ï¼š

- èŠ‚ç‚¹æ•°ï¼š$G'$ æœ‰ $2|V|$ ä¸ªèŠ‚ç‚¹ï¼ˆæ¯ä¸ªåŸå§‹èŠ‚ç‚¹æ‹†åˆ†ä¸ºä¸¤ä¸ªï¼‰ã€‚
- è¾¹æ•°ï¼š$G'$ æœ‰ $|E| + |V|$ æ¡è¾¹ï¼ˆåŸå§‹æ¯æ¡è¾¹å¯¹åº”ä¸€æ¡æ–°è¾¹ï¼ŒåŠ ä¸Šæ¯ä¸ªèŠ‚ç‚¹çš„æ–°è¾¹ï¼‰ã€‚
- å› æ­¤ï¼Œå›¾çš„å¤§å°ä¸º $O(|V| + |E|)$ï¼Œç®—æ³•å¤æ‚æ€§ä¸æ ‡å‡†æœ€å¤§æµç®—æ³•ç›¸åŒï¼ˆå¦‚ Dinic ç®—æ³•çš„ $O(|V|^2 |E|)$ æˆ– Edmonds-Karp çš„ $O(|V| |E|^2)$ï¼‰ã€‚è½¬æ¢è¿‡ç¨‹æ˜¯çº¿æ€§æ—¶é—´çš„ï¼Œæ•´ä½“ç®—æ³•ä¸ºå¤šé¡¹å¼æ—¶é—´ã€‚

### æ­£ç¡®æ€§è§£é‡Š

èŠ‚ç‚¹æ‹†åˆ†æ³•çš„æ ¸å¿ƒåœ¨äºå°†èŠ‚ç‚¹å®¹é‡è½¬åŒ–ä¸ºè¾¹å®¹é‡ï¼Œä»è€Œå°†ç‚¹å®¹é‡é—®é¢˜è½¬åŒ–ä¸ºæ ‡å‡†æœ€å¤§æµé—®é¢˜ã€‚ä»¥ä¸‹é€šè¿‡ä¸‰ä¸ªæ–¹é¢è¯æ˜æ­£ç¡®æ€§ï¼š**å¯è¡Œæ€§ä¿æŒ**ã€**å®¹é‡çº¦æŸä¿æŒ**å’Œ**æœ€ä¼˜æ€§ä¿æŒ**ã€‚

#### 1. å¯è¡Œæ€§ä¿æŒï¼ˆåŸå§‹å›¾å¯è¡Œæµå¯¹åº” $G'$ å¯è¡Œæµï¼‰

- å‡è®¾åŸå§‹å›¾ $G$ ä¸­å­˜åœ¨ä¸€ä¸ªå¯è¡Œæµ $f$ï¼Œæ»¡è¶³æ‰€æœ‰èŠ‚ç‚¹å®¹é‡çº¦æŸï¼ˆå³å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ $i$ï¼Œæµç» $i$ çš„æ€»æµé‡ $\leq c_i$ï¼‰å’Œæµå®ˆæ’ï¼ˆå¯¹äºä¸­é—´èŠ‚ç‚¹ï¼Œæµå…¥ç­‰äºæµå‡ºï¼›å¯¹äºæºç‚¹ï¼Œåªæœ‰æµå‡ºï¼›å¯¹äºæ±‡ç‚¹ï¼Œåªæœ‰æµå…¥ï¼‰ã€‚

- åœ¨     $    G'    $   ä¸­æ„é€ æµ  $ f' $ ï¼š

    - å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ $i$ï¼Œè®¾ $i_{\text{in}} \to i_{\text{out}}$ è¾¹çš„æµå€¼ä¸ºæµç»åŸå§‹èŠ‚ç‚¹ $i$ çš„æ€»æµé‡ï¼ˆç”±äºèŠ‚ç‚¹å®¹é‡çº¦æŸï¼Œæ­¤å€¼ $\leq c_i$ï¼‰ã€‚
    - å¯¹äºåŸå§‹è¾¹ $(u, v)$ï¼Œè®¾ $u_{\text{out}} \to v_{\text{in}}$ è¾¹çš„æµå€¼ä¸º $f(u, v)$ï¼ˆå› ä¸ºè¾¹å®¹é‡æ— é™ï¼Œæµå€¼ä¸è¢«é™åˆ¶ï¼‰ã€‚

- æµå®ˆæ’åœ¨  $ G' $  ä¸­è‡ªåŠ¨æ»¡è¶³ï¼š

    - åœ¨ $i_{\text{in}}$ï¼šåªæœ‰è¾“å…¥è¾¹å’Œè¾“å‡ºè¾¹åˆ° $i_{\text{out}}$ï¼Œå› æ­¤è¿›å…¥ $i_{\text{in}}$ çš„æ€»æµé‡ï¼ˆæ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„è¾“å‡ºèŠ‚ç‚¹ï¼‰ç­‰äºæµå‡ºåˆ° $i_{\text{out}}$ çš„æµé‡ï¼ˆå› ä¸º $i_{\text{in}} \to i_{\text{out}}$ æ˜¯å”¯ä¸€è¾“å‡ºè¾¹ï¼‰ã€‚
    - åœ¨ $i_{\text{out}}$ï¼šåªæœ‰è¾“å…¥è¾¹æ¥è‡ª $i_{\text{in}}$ å’Œè¾“å‡ºè¾¹åˆ°å…¶ä»–èŠ‚ç‚¹çš„è¾“å…¥èŠ‚ç‚¹ï¼Œå› æ­¤æµå…¥ç­‰äºæµå‡ºã€‚
    - æºç‚¹ $s_{\text{in}}$ æ²¡æœ‰è¾“å…¥è¾¹ï¼ˆæ˜¯ $G'$ çš„æºï¼‰ï¼Œè¾“å‡ºåˆ° $s_{\text{out}}$ çš„æµé‡å— $c_s$ é™åˆ¶ï¼Œå¯¹åº”åŸå§‹æºç‚¹æµå‡ºã€‚
    - æ±‡ç‚¹ $t_{\text{out}}$ æ²¡æœ‰è¾“å‡ºè¾¹ï¼ˆæ˜¯ $G'$ çš„æ±‡ï¼‰ï¼Œè¾“å…¥æ¥è‡ª $t_{\text{in}}$ï¼Œæµé‡å— $c_t$ é™åˆ¶ã€‚

- å› æ­¤ï¼Œ$f'$ æ˜¯ $G'$ çš„å¯è¡Œæµï¼Œä¸”æµå€¼ç­‰äºåŸå§‹æµå€¼ã€‚

#### 2. å®¹é‡çº¦æŸä¿æŒï¼ˆç‚¹å®¹é‡çº¦æŸç­‰ä»·äºæ‹†åˆ†è¾¹å®¹é‡ï¼‰

- åœ¨åŸå§‹å›¾ä¸­ï¼ŒèŠ‚ç‚¹å®¹é‡çº¦æŸè¦æ±‚æµç»èŠ‚ç‚¹ $i$ çš„æ€»æµé‡ $\leq c_i$ã€‚
- åœ¨ $G'$ ä¸­ï¼Œè¾¹ $i_{\text{in}} \to i_{\text{out}}$ çš„å®¹é‡ä¸º $c_i$ã€‚æ— è®ºæµé‡å¦‚ä½•é€šè¿‡å…¶ä»–è¾¹è¿›å…¥ $i_{\text{in}}$ æˆ–ä» $i_{\text{out}}$ æµå‡ºï¼Œæµé‡å¿…é¡»ç»è¿‡æ­¤è¾¹ï¼Œå› æ­¤å…¶æµå€¼ï¼ˆå³æµç»èŠ‚ç‚¹ $i$ çš„æµé‡ï¼‰ä¸è¶…è¿‡ $c_i$ã€‚
- åŸå§‹å›¾çš„æ— é™è¾¹å®¹é‡åœ¨ $G'$ ä¸­ç”±æ— é™å®¹é‡çš„è¾¹ï¼ˆæˆ–å¤§å®¹é‡è¾¹ $u_{\text{out}} \to v_{\text{in}}$ï¼‰å¤„ç†ï¼Œä¸é™åˆ¶æµé‡ã€‚
- å› æ­¤ï¼Œä»»ä½• $G'$ çš„å¯è¡Œæµå¯¹åº”äºåŸå§‹å›¾çš„å¯è¡Œæµï¼Œæ»¡è¶³æ‰€æœ‰èŠ‚ç‚¹å®¹é‡çº¦æŸã€‚

#### 3. æœ€ä¼˜æ€§ä¿æŒï¼ˆæœ€å¤§æµå€¼ç­‰ä»·ï¼‰

- ç”±äºè½¬æ¢æ˜¯åŒå°„çš„ï¼ˆbijectiveï¼‰ï¼ŒåŸå§‹å›¾çš„ä»»ä½•å¯è¡Œæµå¯¹åº” $G'$ çš„ä¸€ä¸ªå¯è¡Œæµï¼Œåä¹‹äº¦ç„¶ã€‚
- æœ€å¤§æµå€¼ç›¸åŒï¼šåŸå§‹å›¾çš„æœ€å¤§æµå€¼ç­‰äº $ G' $  ä¸­ä»  $ s_{\text{in}} $  åˆ°  $ t_{\text{out}} $ çš„æœ€å¤§æµå€¼ã€‚
    - è¿™æ˜¯å› ä¸ºï¼š
        - æµå€¼å®šä¹‰ä¸ºæºç‚¹åˆ°æ±‡ç‚¹çš„æ€»æµé‡ã€‚
        - åœ¨åŸå§‹å›¾ä¸­ï¼Œæºç‚¹ $s$ çš„æ€»æµå‡ºé‡ç­‰äºåœ¨ $G'$ ä¸­ $s_{\text{in}} \to s_{\text{out}}$ çš„æµå€¼ï¼ˆå— $c_s$ é™åˆ¶ï¼‰ã€‚
        - åœ¨ $G'$ ä¸­ï¼Œæœ€å¤§æµç®—æ³•ä¼šæœ€å¤§åŒ–ä» $s_{\text{in}}$ åˆ° $t_{\text{out}}$ çš„æµï¼ŒåŒæ—¶å—é™äºæ‰€æœ‰ $i_{\text{in}} \to i_{\text{out}}$ çš„å®¹é‡ $c_i$ï¼Œè¿™æ­£å¥½å¯¹åº”äº†åŸå§‹é—®é¢˜ä¸­æœ€å¤§åŒ–æµé‡çš„åŒæ—¶æ»¡è¶³èŠ‚ç‚¹å®¹é‡çº¦æŸã€‚

- æ ‡å‡†æœ€å¤§æµç®—æ³•ï¼ˆå¦‚ Dinicï¼‰åœ¨ $G'$ ä¸Šä¿è¯æ‰¾åˆ°æœ€å¤§æµï¼Œå› æ­¤ä¹Ÿå¾—åˆ°åŸé—®é¢˜çš„æœ€å¤§æµã€‚

### ä¾‹å­è¯´æ˜

è€ƒè™‘ä¸€ä¸ªç®€å•ä¾‹å­ï¼šå›¾ä¸­æœ‰èŠ‚ç‚¹ $V = \{s, a, t\}$ï¼Œè¾¹ $E = \{(s, a), (a, t)\}$ï¼ŒèŠ‚ç‚¹å®¹é‡ $c_s = 2, c_a = 3, c_t = 2$ï¼ˆè¾¹å®¹é‡æ— ç©·å¤§ï¼‰ã€‚

- **åŸå§‹å›¾**ï¼š
    - èŠ‚ç‚¹ï¼šsï¼ˆæºç‚¹ï¼‰ã€aï¼ˆä¸­é—´ç‚¹ï¼‰ã€tï¼ˆæ±‡ç‚¹ï¼‰ã€‚
    - è¾¹ï¼š(s, a) å’Œ (a, t)ï¼Œå®¹é‡æ— ç©·å¤§ã€‚
    - çº¦æŸï¼šs çš„æ€»æµå‡º â‰¤ 2ï¼Œa çš„æ€»æµé‡ â‰¤ 3ï¼Œt çš„æ€»æµå…¥ â‰¤ 2ã€‚
- **æ„é€  G'**ï¼š
    - åˆ›å»ºèŠ‚ç‚¹ï¼šs_in, s_out, a_in, a_out, t_in, t_outã€‚
    - æ·»åŠ èŠ‚ç‚¹è¾¹ï¼šs_in â†’ s_outï¼ˆå®¹é‡ 2ï¼‰ï¼Œa_in â†’ a_outï¼ˆå®¹é‡ 3ï¼‰ï¼Œt_in â†’ t_outï¼ˆå®¹é‡ 2ï¼‰ã€‚
    - æ·»åŠ åŸå§‹è¾¹å¯¹åº”ï¼šs_out â†’ a_inï¼ˆå®¹é‡ âˆï¼‰ï¼Œa_out â†’ t_inï¼ˆå®¹é‡ âˆï¼‰ã€‚
    - æºç‚¹ä¸º s_inï¼Œæ±‡ç‚¹ä¸º t_outã€‚
- **åœ¨ G' ä¸Šè¿è¡Œæœ€å¤§æµç®—æ³•**ï¼š
    - æœ€å¤§æµå¯èƒ½ä¸º 2ï¼ˆå› ä¸º s_in â†’ s_out å®¹é‡ 2ï¼Œä¸” t_in â†’ t_out å®¹é‡ 2ï¼‰ã€‚
    - ä¾‹å¦‚ï¼Œæµé‡ï¼šs_in â†’ s_out æµå€¼ 2ï¼Œs_out â†’ a_in æµå€¼ 2ï¼Œa_in â†’ a_out æµå€¼ 2ï¼Œa_out â†’ t_in æµå€¼ 2ï¼Œt_in â†’ t_out æµå€¼ 2ã€‚
    - æ¢å¤åŸå§‹æµï¼š(s, a) æµå€¼ 2ï¼Œ(a, t) æµå€¼ 2ï¼Œæ»¡è¶³èŠ‚ç‚¹å®¹é‡ï¼ˆs æµå‡º 2ï¼Œa æµé‡ 2ï¼Œt æµå…¥ 2ï¼‰ã€‚
- **è‹¥èŠ‚ç‚¹å®¹é‡æ›´å¤§**ï¼Œä¾‹å¦‚ c_a = 4ï¼Œåˆ™æœ€å¤§æµå¯è¾¾ 2ï¼ˆå—é™ c_s å’Œ c_tï¼‰ã€‚

### å®ç°æ³¨æ„äº‹é¡¹

- **æ— ç©·å¤§å®¹é‡å¤„ç†**ï¼šåœ¨ä»£ç ä¸­ï¼Œè¾¹ $(u_{\text{out}}, v_{\text{in}})$ çš„å®¹é‡è®¾ç½®ä¸ºä¸€ä¸ªå¤§æ•°ï¼ˆå¦‚æ‰€æœ‰ $c_i$ ä¹‹å’Œï¼‰ï¼Œä»¥é¿å…æ— ç©·å¤§å¸¦æ¥çš„é—®é¢˜ã€‚ç†è®ºä¸­ä¸å½±å“æ­£ç¡®æ€§ã€‚
- **ç®—æ³•é€‰æ‹©**ï¼šæ¨èä½¿ç”¨é«˜æ•ˆçš„æœ€å¤§æµç®—æ³•ï¼Œå¦‚ Dinic ç®—æ³•ï¼ˆå¤æ‚åº¦ $O(|V|^2 |E|)$ï¼‰ï¼Œå°¤å…¶å½“å›¾è¾ƒå¤§æ—¶ã€‚
- **æ‰©å±•æ€§**ï¼šè¯¥æ–¹æ³•ä¹Ÿé€‚ç”¨äºæ— å‘å›¾ï¼ˆå°†æ— å‘è¾¹è½¬ä¸ºä¸¤ä¸ªæœ‰å‘è¾¹ï¼‰å’Œå¤šæºå¤šæ±‡é—®é¢˜ï¼ˆæ·»åŠ è¶…çº§æºå’Œè¶…çº§æ±‡ï¼‰ã€‚
- **ä»£ç å®ç°**ï¼šåœ¨ Python ä¸­ï¼Œå¯ä½¿ç”¨ NetworkX åº“æˆ–è‡ªå®šä¹‰å®ç°ï¼ˆä¾‹å¦‚ï¼ŒåŸºäº BFS çš„å¢å¹¿è·¯å¾„æœç´¢ï¼‰ã€‚

è¿™ä¸ªç®—æ³•é«˜æ•ˆä¸”æ­£ç¡®ï¼Œèƒ½å°†ç‚¹å®¹é‡é—®é¢˜è½¬åŒ–ä¸ºæ ‡å‡†æœ€å¤§æµé—®é¢˜æ±‚è§£ã€‚ä»»ä½•æ ‡å‡†æœ€å¤§æµç®—æ³•çš„æ­£ç¡®æ€§åŸºç¡€ï¼ˆå¦‚æœ€å¤§æµæœ€å°å‰²å®šç†ï¼‰åœ¨ $G'$ ä¸Šä»é€‚ç”¨ï¼Œä»è€Œç¡®ä¿æ•´ä¸ªæ–¹æ³•çš„æ­£ç¡®æ€§ã€‚

------

## 6

é—®é¢˜æè¿°

æŸå·¥å‚éœ€è¦é‡‡è´­ K ç§é›¶ä»¶$j \in [K]$ï¼Œæ¯ç§é›¶ä»¶ j çš„æ—¥éœ€æ±‚é‡ä¸º$ d_j$ã€‚æœ‰ m å®¶ä¾›åº”å•†$i \in [m]$ï¼Œç¬¬ i å®¶ä¾›åº”å•†æä¾›é›¶ä»¶ j çš„å•ä½ä»·æ ¼ä¸º $a_{ij}$ï¼Œä¸”æœ€å¤šä¾›åº” $c_{ij}$ ä¸ªé›¶ä»¶ jã€‚ç›®æ ‡æ˜¯è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ±‚è§£æœ€å°åŒ–æ€»é‡‡è´­æˆæœ¬çš„é—®é¢˜ï¼Œå¹¶ç¡®ä¿æ»¡è¶³æ‰€æœ‰é›¶ä»¶éœ€æ±‚ã€‚å¦‚æœæ€»ä¾›åº”èƒ½åŠ›æ— æ³•æ»¡è¶³æ‰€æœ‰éœ€æ±‚ï¼Œç®—æ³•åº”æŠ¥å‘Šé—®é¢˜ä¸å¯è¡Œã€‚

ç®—æ³•è®¾è®¡

ç”±äºæ¯ä¸ªé›¶ä»¶çš„é‡‡è´­å†³ç­–ç›¸äº’ç‹¬ç«‹ï¼ˆå³ï¼Œä¾›åº”å•†å¯¹æ¯ç§é›¶ä»¶çš„ä¾›åº”èƒ½åŠ› $c_{ij} $æ˜¯ç‹¬ç«‹çš„ï¼Œæ²¡æœ‰å…±äº«çš„æ€»ä¾›åº”çº¦æŸï¼‰ï¼Œé—®é¢˜å¯ä»¥åˆ†è§£ä¸º K ä¸ªç‹¬ç«‹çš„å­é—®é¢˜ï¼Œæ¯ä¸ªå­é—®é¢˜é’ˆå¯¹ä¸€ç§é›¶ä»¶ jï¼Œæ±‚è§£æœ€å°é‡‡è´­æˆæœ¬ä»¥æ»¡è¶³éœ€æ±‚ $d_j$ã€‚å¯¹äºæ¯ä¸ªé›¶ä»¶ jï¼Œæœ€å°æˆæœ¬å­é—®é¢˜å¯ä»¥é€šè¿‡è´ªå¿ƒç­–ç•¥æ±‚è§£ï¼šæŒ‰å•ä½ä»·æ ¼ $a_{ij} $ä»ä½åˆ°é«˜æ’åºä¾›åº”å•†ï¼Œå¹¶ä»æœ€ä½ä»·æ ¼çš„ä¾›åº”å•†å¼€å§‹é‡‡è´­ï¼Œç›´åˆ°æ»¡è¶³éœ€æ±‚ $d_j$ã€‚

ç®—æ³•æ­¥éª¤
åˆå§‹åŒ–æ€»æˆæœ¬ï¼šè®¾ total_cost = 0ã€‚

éå†æ¯ç§é›¶ä»¶ï¼šå¯¹äºæ¯ä¸ªé›¶ä»¶$ j \in [K]$ æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

æ£€æŸ¥éœ€æ±‚ï¼šå¦‚æœ $d_j $= 0ï¼ˆå³è¯¥é›¶ä»¶æ— éœ€æ±‚ï¼‰ï¼Œåˆ™è·³è¿‡å½“å‰é›¶ä»¶ï¼ˆæˆæœ¬ä¸º 0ï¼‰ã€‚

æ„å»ºå¯ç”¨ä¾›åº”å•†åˆ—è¡¨ï¼šæ”¶é›†æ‰€æœ‰èƒ½æä¾›é›¶ä»¶ j çš„ä¾›åº”å•†ï¼Œå³ $c_{ij} $> 0 çš„ä¾›åº”å•†ã€‚åˆ—è¡¨å…ƒç´ ä¸ºå…ƒç»„ $i, a_{ij}, c_{ij}$ï¼Œå…¶ä¸­ i æ˜¯ä¾›åº”å•†ç´¢å¼•ã€‚

æ£€æŸ¥å¯è¡Œæ€§ï¼šå¦‚æœåˆ—è¡¨ä¸ºç©ºï¼ˆæ— ä¾›åº”å•†èƒ½æä¾›é›¶ä»¶ jï¼‰ä¸” $d_j $> 0ï¼Œåˆ™é—®é¢˜ä¸å¯è¡Œï¼Œç®—æ³•è¾“å‡ºâ€œä¸å¯è¡Œâ€å¹¶ç»ˆæ­¢ã€‚

æ’åºä¾›åº”å•†ï¼šå¯¹å¯ç”¨ä¾›åº”å•†åˆ—è¡¨æŒ‰å•ä½ä»·æ ¼ $a_{ij} $å‡åºæ’åºï¼ˆå³ä»·æ ¼ä»ä½åˆ°é«˜ï¼‰ã€‚

è´ªå¿ƒé‡‡è´­ï¼š

è®¾å‰©ä½™éœ€æ±‚ rem = $d_j$ å’Œå½“å‰é›¶ä»¶æˆæœ¬$ cost_j$ = 0ã€‚

éå†æ’åºåçš„ä¾›åº”å•†åˆ—è¡¨ï¼ˆä»æœ€ä½ä»·æ ¼å¼€å§‹ï¼‰ï¼š

è®¡ç®—å¯é‡‡è´­é‡ï¼šamount = min(rem,$ c_{ij}$)ã€‚

æ›´æ–°æˆæœ¬ï¼š$cost_j $+= amount * $a_{ij}$ã€‚

æ›´æ–°å‰©ä½™éœ€æ±‚ï¼šrem -= amountã€‚

å¦‚æœ rem == 0ï¼Œåˆ™éœ€æ±‚æ»¡è¶³ï¼Œè·³å‡ºå¾ªç¯ã€‚

å¦‚æœéå†ç»“æŸå rem > 0ï¼ˆå³æ‰€æœ‰ä¾›åº”å•†çš„æ€»ä¾›åº”èƒ½åŠ›ä¸è¶³ï¼‰ï¼Œåˆ™é—®é¢˜ä¸å¯è¡Œï¼Œè¾“å‡ºâ€œä¸å¯è¡Œâ€å¹¶ç»ˆæ­¢ã€‚

ç´¯åŠ æ€»æˆæœ¬ï¼šå¦‚æœéœ€æ±‚æ»¡è¶³ï¼Œtotal_cost += $cost_j$ã€‚
è¾“å‡ºç»“æœï¼šå¦‚æœæ‰€æœ‰é›¶ä»¶éœ€æ±‚å‡æ»¡è¶³ï¼Œè¾“å‡º total_cost ä½œä¸ºæœ€å°æ€»é‡‡è´­æˆæœ¬ã€‚

æ—¶é—´å¤æ‚åº¦
å¯¹äºæ¯ä¸ªé›¶ä»¶ jï¼Œæ„å»ºä¾›åº”å•†åˆ—è¡¨çš„æ—¶é—´ä¸º O(m)ï¼ˆéå†æ‰€æœ‰ä¾›åº”å•†ï¼‰ã€‚

å¯¹ä¾›åº”å•†æ’åºçš„æ—¶é—´ä¸º O($m \log m$)ï¼ˆä½¿ç”¨å¿«é€Ÿæ’åºæˆ–å½’å¹¶æ’åºï¼‰ã€‚

è´ªå¿ƒé‡‡è´­çš„æ‰«ææ—¶é—´ä¸º O(m)ã€‚

å› æ­¤ï¼Œå¤„ç†ä¸€ä¸ªé›¶ä»¶ j çš„æ€»æ—¶é—´ä¸º O($m + m \log m$) = O($m \log m$)ã€‚

å¯¹äºæ‰€æœ‰ K ä¸ªé›¶ä»¶ï¼Œæ€»æ—¶é—´ä¸º O($K \cdot m \log m$)ã€‚

è¾“å…¥å¤§å°ä¸º O($K m$)ï¼ˆæ¯ä¸ªä¾›åº”å•†-é›¶ä»¶å¯¹æœ‰ä»·æ ¼å’Œå®¹é‡ï¼‰ï¼Œå› æ­¤ç®—æ³•æ˜¯è¾“å…¥å¤§å°çš„å¤šé¡¹å¼æ—¶é—´ã€‚

ç©ºé—´å¤æ‚åº¦
ç©ºé—´ä¸»è¦ç”¨äºå­˜å‚¨è¾“å…¥æ•°æ®å’Œä¸­é—´åˆ—è¡¨ã€‚æ¯ä¸ªé›¶ä»¶ j çš„ä¾›åº”å•†åˆ—è¡¨æœ€å¤šæœ‰ m ä¸ªå…ƒç´ ï¼Œå› æ­¤é¢å¤–ç©ºé—´ä¸º O($K m$)ã€‚

æ€»ä½“ç©ºé—´å¤æ‚åº¦ä¸º O($K m$)ï¼Œä¸è¾“å…¥å¤§å°ç›¸åŒã€‚

æ­£ç¡®æ€§è§£é‡Š

ç®—æ³•æ­£ç¡®æ€§åŸºäºä»¥ä¸‹ä¸¤ä¸ªå…³é”®ç‚¹ï¼šå­é—®é¢˜ç‹¬ç«‹æ€§å’Œè´ªå¿ƒç­–ç•¥æœ€ä¼˜æ€§ã€‚
å­é—®é¢˜ç‹¬ç«‹æ€§ï¼š

çº¦æŸåˆ†æï¼šä¾›åº”å•†çš„ä¾›åº”èƒ½åŠ›$ c_{ij}$ æ˜¯ç‰¹å®šäºé›¶ä»¶ j çš„ï¼ˆå³æ¯ä¸ªé›¶ä»¶çš„ä¾›åº”å†³ç­–ä¸å…±äº«ä»»ä½•çº¦æŸï¼‰ã€‚é›¶ä»¶ä¹‹é—´æ— è€¦åˆï¼Œå› æ­¤æ€»æœ€å°æˆæœ¬ç­‰äºæ¯ä¸ªé›¶ä»¶ j çš„æœ€å°æˆæœ¬ä¹‹å’Œã€‚

å¯è¡Œæ€§ï¼šå¦‚æœæ‰€æœ‰é›¶ä»¶ j çš„éœ€æ±‚éƒ½èƒ½ç‹¬ç«‹æ»¡è¶³ï¼Œåˆ™æ•´ä¸ªé—®é¢˜å¯è¡Œï¼›å¦åˆ™ï¼Œä»»æ„é›¶ä»¶ j æ— æ³•æ»¡è¶³éœ€æ±‚ä¼šå¯¼è‡´æ•´ä½“ä¸å¯è¡Œã€‚ç®—æ³•åœ¨éå†é›¶ä»¶æ—¶ç«‹å³æ£€æŸ¥å¯è¡Œæ€§ã€‚
è´ªå¿ƒç­–ç•¥æœ€ä¼˜æ€§ï¼ˆé’ˆå¯¹å•ä¸ªé›¶ä»¶ jï¼‰ï¼š

é—®é¢˜æ¨¡å‹ï¼šå¯¹äºå›ºå®šé›¶ä»¶ jï¼Œé—®é¢˜å¯å»ºæ¨¡ä¸ºï¼šæœ€å°åŒ–$ \sum_{i} a_{ij} x_{ij}$ï¼Œæ»¡è¶³ $\sum_{i} x_{ij} \geq d_j$ ä¸” $0 \leq x_{ij} \leq c_{ij}$ã€‚å…¶ä¸­ï¼Œ$x_{ij}$ æ˜¯ä»ä¾›åº”å•† i é‡‡è´­é›¶ä»¶ j çš„æ•°é‡ã€‚

è´ªå¿ƒé€‰æ‹©ï¼šå°†ä¾›åº”å•†æŒ‰ $a_{ij} $å‡åºæ’åºï¼Œå¹¶ä¼˜å…ˆä»æœ€ä½ä»·æ ¼ä¾›åº”å•†é‡‡è´­æœ€å¤§å¯èƒ½é‡ï¼ˆå³å°½å¯èƒ½ä½¿ç”¨$ c_{ij}$ï¼‰ï¼Œç›´åˆ°æ»¡è¶³éœ€æ±‚ $d_j$ã€‚

æœ€ä¼˜æ€§è¯æ˜ï¼ˆåè¯æ³•ï¼‰ï¼š

å‡è®¾å­˜åœ¨ä¸€ä¸ªæ›´ä¼˜è§£ï¼ˆæˆæœ¬æ›´ä½ï¼‰ï¼Œå…¶ä¸­æŸä¸ªé«˜ä»·æ ¼ä¾›åº”å•†ï¼ˆå¦‚$ a_{i_2 j} > a_{i_1 j}$ï¼‰è¢«ä¼˜å…ˆä½¿ç”¨ï¼Œè€Œä½ä»·æ ¼ä¾›åº”å•† i_1 æœªè¢«å……åˆ†åˆ©ç”¨ï¼ˆå³ $x_{i_1 j} < c_{i_1 j}$ï¼‰ã€‚

åˆ™å¯ä»¥é€šè¿‡å‡å°‘é«˜ä»·æ ¼ä¾›åº”å•†çš„é‡‡è´­é‡ï¼Œå¢åŠ ä½ä»·æ ¼ä¾›åº”å•†çš„é‡‡è´­é‡ï¼ˆå› ä¸º $a_{i_2 j} > a_{i_1 j}$ï¼‰ï¼Œæ„é€ ä¸€ä¸ªæ–°è§£ï¼šè®¾$ \delta = \min(c_{i_1 j} - x_{i_1 j}, x_{i_2 j}) > 0$ï¼Œæ›´æ–°$ x_{i_1 j} = x_{i_1 j} + \delta$ å’Œ $x_{i_2 j} = x_{i_2 j} - \delta$ã€‚

æ–°è§£çš„æˆæœ¬å˜åŒ–ä¸º $\delta \cdot (a_{i_1 j} - a_{i_2 j}) < 0$ï¼ˆå› ä¸º$ a_{i_1 j} < a_{i_2 j}$ï¼‰ï¼Œæˆæœ¬é™ä½ï¼Œä¸åŸè§£â€œæ›´ä¼˜â€çŸ›ç›¾ã€‚

å› æ­¤ï¼Œä»»ä½•ä¸ä»æœ€ä½ä»·æ ¼ä¾›åº”å•†ä¼˜å…ˆé‡‡è´­çš„ç­–ç•¥éƒ½ä¸æ˜¯æœ€ä¼˜ã€‚è´ªå¿ƒç­–ç•¥ï¼ˆæŒ‰ä»·æ ¼æ’åºå¹¶é¡ºåºé‡‡è´­ï¼‰ç¡®ä¿äº†å±€éƒ¨æœ€ä¼˜ï¼Œä¸”ç”±äºé—®é¢˜ç»“æ„ç®€å•ï¼ˆçº¿æ€§ç›®æ ‡å‡½æ•°å’Œç‹¬ç«‹å®¹é‡çº¦æŸï¼‰ï¼Œå±€éƒ¨æœ€ä¼˜å³ä¸ºå…¨å±€æœ€ä¼˜ã€‚

éœ€æ±‚æ»¡è¶³ï¼šè´ªå¿ƒæ‰«æç¡®ä¿åœ¨ä¾›åº”å•†æ’åºåå……åˆ†åˆ©ç”¨ä½ä»·èµ„æºï¼›å¦‚æœæ’åºåæ€»ä¾›åº”èƒ½åŠ›å°äº $d_j$ï¼Œåˆ™é—®é¢˜ä¸å¯è¡Œã€‚

ç»¼ä¸Šï¼Œè¯¥ç®—æ³•é«˜æ•ˆåœ°æ±‚è§£äº†æœ€å°é‡‡è´­æˆæœ¬é—®é¢˜ï¼Œå¹¶ä¿è¯æ­£ç¡®æ€§ã€‚å®é™…å®ç°ä¸­ï¼Œè‹¥å‚æ•°å‡ä¸ºæ•´æ•°ï¼Œé‡‡è´­é‡ $x_{ij} $è‡ªç„¶ä¸ºæ•´æ•°ï¼›è‹¥éœ€æ±‚$ d_j$ æˆ–å®¹é‡$ c_{ij}$ ä¸ºå®æ•°ï¼Œç®—æ³•åŒæ ·é€‚ç”¨ã€‚



------

## 7

**KÃ¶nig å®šç†**æŒ‡å‡ºï¼šåœ¨ä»»æ„äºŒåˆ†å›¾ä¸­ï¼Œæœ€å¤§åŒ¹é…æ•° = æœ€å°é¡¶ç‚¹è¦†ç›–æ•°ã€‚è¯¥ç»“è®ºæºäºçº¿æ€§è§„åˆ’å¯¹å¶æ€§ï¼Œä¹Ÿå¯ç”¨ç½‘ç»œæµæ¨¡å‹è¯æ˜ã€‚

è¯¥ç­‰ä»·æ€§å¸¦æ¥å®é™…ç®—æ³•ä¼˜åŠ¿ï¼š

- ä½¿ç”¨ Hopcroftâ€“Karp ç®—æ³•åœ¨ $O(E\sqrt{V})$ æ—¶é—´å†…æ‰¾åˆ°æœ€å¤§åŒ¹é…ï¼›
- å†ç”¨å¯è¾¾æ ‡è®°æ³•æ„é€ æœ€å°é¡¶ç‚¹è¦†ç›–ã€‚

å› æ­¤ï¼ŒäºŒåˆ†å›¾çš„æœ€å°é¡¶ç‚¹è¦†ç›–å¯åœ¨å¤šé¡¹å¼æ—¶é—´å†…é«˜æ•ˆæ±‚è§£ã€‚

